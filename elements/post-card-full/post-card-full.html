<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="post-card-full">
<template>
  <style include="shared-styles"></style>
  <iron-ajax
  url="[[url]]"
  handle-as="json"
  on-response="onRecv"
  last-response="{{ajaxResponse}}"
  id="ajax" verbose="true"></iron-ajax>
  <h2 class="page-title"><span>[[ajaxResponse.title]]</span></h2>
  <h5 class="post-metadata"><span>[[ajaxResponse.date]]</span></h5>
  <div class="paper-font-body" id="postContainer"></div>
</template>
<script>
  (function() {
    'use strict';

    Polymer({
      is: 'post-card-full',

      properties: {
        url: {
          type: String,
          notify: true,
          observer: "onUpdate"
        }
      },

      onUpdate: function() {
        console.log("UPD: " + this.url);
        this.$.ajax.generateRequest();
      },

      onRecv: function() {
        this.$.postContainer.innerHTML = this.$.ajax.lastResponse.post;
        this.fire('toolbar-update', this.$.ajax.lastResponse.toolbar);
      },

      getToolbar: function() {
        if (this.$.ajax.lastResponse) {
          return this.$.ajax.lastResponse.toolbar;
        } else {
          return 'qmb.jpg';
        }
      }
    });
  })(document);
</script>

</dom-module>
